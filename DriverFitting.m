% Optimization Driver/ Sensitivity analysis
% clear; 
%    close all; clc;
tic
% plotting while the optimization runs
flag_plot = 1; % flag_plot = 1 ==>  plot
%%%%%%%Producing the first Generetion%%%%%%%%
%% adjustable variables are multiplied to the old variables
% adjustable_variables=[1.7200*1.1    1.4297    1.8300    1.4357*20.4    1.4269*20.4    1.6696*0.005    0.04    0.9428*0.005    0.5000    3]% 40
% adjustable_variables=[ 1.7386    1.5022    1.4040    1.8637    1.4793    1.4693    0.6281    1.9245    0.5000    2.3293] % 43
% adjustable_variables=[ 1.7386*1.35*2.5    1.5022    1.4040    1.8637    1.4793*2    1.4693*2    0.6281*0.5    1.9245    0.5000*0.5    2.3293*1.35]
% var=   [2.5890    1.1653    1.1500    1.2045    0.8821    1.8393    1.0535    2.4003    0.7969    2.8406    1.9741    2.9989    0.6531  0.8058    2.2264    2.5743]
%    var =[ 1.1878    0.7551    0.6083    2.2851    2.8355    2.3636    0.9089    1.8166    1.2483    2.0306    1.1441    1.0037    0.9387 1.6048    1.3561    2.2164]
% var = [1.18783129356751,0.755063156386634,0.608302745025594,2.28505848337249,2.83554452432431,2.36363384319356,0.908906573915146,1.81657209630941,1.24834053130923,2.03062076639212,1.14406033829670,1.00373905093119,0.938658804993310,1.60483521822591,1.35612608368277,2.21635829227022]
% var = [1.18783129356751*1.5,0.755063156386634,0.608302745025594,2.28505848337249,2.83554452432431,2.36363384319356,0.908906573915146,1.81657209630941,1.24834053130923,2.03062076639212,1.14406033829670,1.00373905093119,0.938658804993310,1.60483521822591,2.3,2.21635829227022]
% var = [1.18783129356751*1.43,0.755063156386634,0.608302745025594,2.28505848337249,2.83554452432431,2.36363384319356,0.908906573915146,1.81657209630941,1.24834053130923,2.0,1.14406033829670,1.00373905093119,0.938658804993310,1.60483521822591 ,2 ,2 ]
% 
% var = [1.18783129356751*1.43,0.755063156386634,1.2,2.28505848337249,2.83554452432431,2.36363384319356,0.908906573915146,1.81657209630941,1.24834053130923,2.0,1.14406033829670,1.00373905093119,0.938658804993310,1.60483521822591 ,2 ,0.6 ]
% var = [2,0.500000000000000,1,1.90246862926708,2,1.56862220868428,0.797332691770758,1.81657209630941,1.09478118887239,2,1.58408680948515,1.60243631254408,0.938658804993310,1.67289794988200,1.9,1]
% var = [2.0,0.500000000000000,1,1.90246862926708,2,1.56862220868428,0.797332691770758,1.81657209630941,1.09478118887239,2,1.58408680948515,1.60243631254408,0.938658804993310,1.67289794988200,1.8,0.6]

% var = [2.14 1 1 1000/50 4000/180 6.17/23.1 1.305/1.2825 100/150 1.1198 11.371 7.17 1.577 0.7985 0.7799 1.626 0.6] 
%  var = [1 1 1.6 1 1 1 1 1 1.1198 11.371 7.17 1.577 0.7985 0.7799 1.626 0.6]% values used for mean tac rat with adjusting kstiff and kpassive
% var = [2.1    0.9525    1.1944*1.5    1.0035    1.8037    1.5951    1.1597    1.7872    0.7859    1.6663    1.4476    1.9095    1.1519    1.7675    2 0.5]
% var = [ 0.9774    1.5817    0.9128*1.5    1.6309    1.4893    0.6127    1.5998    1.4116    0.5402    1.8157    1.7444    1.0733    1.1222    1.7827    1.5199 0.6905]
% var = [ 0.9774*1.32    1.5817    0.9128*1.4    1.6309    1.4893    0.6127    1.5998*0.9    1.4116*1.12    0.5402    1.8157    1.7444    1.0733    1.1222    1.7827    2 0.6905]
% var = [ 0.9774*1.3    1.5817    0.9128*1.4    1.6309    1.4893*1.02    0.6127    1.5998*0.9    1.4116*1.12    0.5402*1.3    1.8157    1.7444    1.0733    1.1222    1.7827    2.2 0.6]
% var = [2.6*2  1.2849    1.6255*1.2    0.5000    1.1830*1.2    1.0448    1.1780    0.5956*1.2    1.4676    1.8929*4   1.8346*3    1.8525    1.7045    1.0242    3    0.5]
% var = [ 1.5525/1.63    0.5133    1.9131    1.3379    1.8891    1.7403    1.7194*1.63    0.7508    0.6698    1.7714    1.8059    1.4776    1.3082    0.8494    1.6077    0.8160]
% 1.92464592066313	1.75557540910708	1.84312836258887	1.23130641627380	1.51304863283666	0.602852084126961	1.26218539131091	0.792929679726219	0.669814327131171	1.77136794563577	1.35702398926148	1.37334552646577	1.30125938757062	1.36310950996765	1.60774000972753	1.20541039575702
% 1.81149773216557	1.28491228454243	1.62548319878206	0.500000000000000	1.18298052987497	1.58376029167987	1.17796632806186	1.81008760481233	1.46758702876838	1.89285297460375	1.92654715153344	1.85251567556605	1.70453768577943	1.02418451125715	1.82329924809854	1.84232322457721
% 1.47698108128395	0.513289221145826	1.91314730048849	1.23130641627380	1.42365064365263	0.769597051298401	1.47090928473605	0.792929679726219	0.669814327131171	1.70299324079682	1.80591232497219	1.49864964630428	1.30816861019252	0.673169142551150	1.60774000972753	1.03637993143058
% 1.54029066799417	0.824802997095321	1.46839932394296	1.43739624770634	1.49848405681599	0.530249116506925	1.55935675115323	1.31070824318306	0.700182333811717	1.93476359059289	1.97765831024864	0.978147585522894	1.59859451728802	1.72376229019622	1.82464235638692	0.549171656719085
% 1.81149773216557	1.28491228454243	1.62548319878206	0.500000000000000	1.18298052987497	1.04475515122116	1.17796632806186	0.595554453508353	1.46758702876838	1.89285297460375	1.83464665448029	1.85251567556605	1.70453768577943	1.02418451125715	1.82329924809854	1.84232322457721
% 1.64860037641656	1.30776963814884	1.45838224315620	0.766604755794347	1.58780058107716	1.66979993127668	1.43361221916716	1.63061398905641	1.24984502631487	1.95656814763700	1.92727542609161	1.01532003606808	0.716314335317795	0.672539492283114	1.65502459182752	1.78304757052419
% var = [   1.8616/1.5    1.7228    1.9432    0.9809    1.0248    0.8868    1.4304*1.5    1.5103    0.8826    4.4748*1.1    2.1132    0.9160    1.0171    0.9865    1.9299    1.0519]
var = [   1.8616/1.5    1.7228    1.9432  0.9809    1.0248    0.8868    1.4304*1.5    1.5103    0.8826    4.4748*1.1    2.1132    1    1    1    1.9299    1*0.1]

 [hill_19 Ca50_19 hill_23 Ca50_23]= getpCa50 (var);       
Max_Force= getMaxForce (var) 


Data.freq =[2 3 4 5 6 7 8 9 10 4 4 4 ];
filename = {'Ca_2Hz.mat', 'Ca_3Hz.mat', 'Ca_4Hz.mat', 'Ca_5Hz.mat', 'Ca_6Hz.mat', 'Ca_7Hz.mat', 'Ca_8Hz.mat', 'Ca_9Hz.mat', 'Ca_10Hz.mat','Ca_4Hz.mat','Ca_4Hz.mat','Ca_4Hz.mat'};
% Set temperature fot the experiment environment
Data.TmpC = 37; % centigrade 
err  = objective_fun_rat_data(var,Data,flag_plot)
toc